<div class="vehicles-dashboard">

  <!-- Actions Bar -->
  <div class="actions-bar">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="filterVehicles()"
      placeholder="Search a vehicle"
    />
    <button class="btn-add" (click)="openCreateForm()">+ Add Vehicle</button>
  </div>

  <!-- Vehicles Table -->
  <table class="vehicles-table">
    <thead>
      <tr>
        <th>Registration</th>
        <th>Brand</th>
        <th>Model</th>
        <th>Year</th>
        <th>Mileage</th>
        <th>Status</th>
        <th>Insurance Date</th>
        <th>Agency ID</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let vehicle of filteredVehicles">
        <td>{{ vehicle.immatriculation }}</td>
        <td>{{ vehicle.marque }}</td>
        <td>{{ vehicle.modele }}</td>
        <td>{{ vehicle.annee }}</td>
        <td>{{ vehicle.kilometrage | number }}</td>
        <td>{{ vehicle.statut }}</td>
        <td>{{ vehicle.date_assurance }}</td>
        <td>{{ vehicle.agence_id }}</td>
        <td class="actions">
          <button class="btn-details" (click)="openEditForm(vehicle)">Edit</button>
          <button class="btn-delete" (click)="deleteVehicle(vehicle)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Modal Form -->
  <div class="modal" *ngIf="showFormModal">
    <div class="modal-content">
      <h3>{{ editingVehicle ? 'Edit Vehicle' : 'Add Vehicle' }}</h3>
      <form [formGroup]="vehicleForm" (ngSubmit)="submitForm()">
        <input formControlName="immatriculation" placeholder="Registration" required />
        <input formControlName="marque" placeholder="Brand" required />
        <input formControlName="modele" placeholder="Model" required />
        <input type="number" formControlName="annee" placeholder="Year" required />
        <input type="number" formControlName="kilometrage" placeholder="Mileage" required />
        <select formControlName="statut">
          <option value="disponible">Available</option>
          <option value="loue">Rented</option>
          <option value="maintenance">Maintenance</option>
          <option value="leasing">Leasing</option>
          <option value="transfert">Transfer</option>
          <option value="reserve">Reserved</option>
        </select>
        <input type="date" formControlName="date_assurance" required />
        <input type="number" formControlName="agence_id" placeholder="Agency ID" required />

        <div class="form-actions">
          <button type="submit">{{ editingVehicle ? 'Update' : 'Create' }}</button>
          <button type="button" (click)="showFormModal = false">Cancel</button>
        </div>
      </form>
    </div>
  </div>

</div>
